One of Britain's biggest service companies has come to grief with disastrous figures and a crash in its shares.